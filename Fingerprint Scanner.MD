# ğŸ” Fingerprint Scanner Bridge

á»¨ng dá»¥ng desktop bridge káº¿t ná»‘i mÃ¡y quÃ©t vÃ¢n tay ZKTeco vá»›i cÃ¡c á»©ng dá»¥ng web thÃ´ng qua REST API.

## ğŸ“‹ Tá»•ng quan

**Fingerprint Scanner Bridge** lÃ  má»™t HTTP server cháº¡y local Ä‘á»ƒ:
- Káº¿t ná»‘i vÃ  Ä‘iá»u khiá»ƒn mÃ¡y quÃ©t vÃ¢n tay ZKTeco
- Cung cáº¥p REST API cho cÃ¡c á»©ng dá»¥ng web
- Thá»±c hiá»‡n quÃ©t vÃ  Ä‘Äƒng kÃ½ vÃ¢n tay vá»›i cháº¥t lÆ°á»£ng cao
- Há»— trá»£ 3-scan enrollment process Ä‘á»ƒ tá»‘i Æ°u hÃ³a Ä‘á»™ chÃ­nh xÃ¡c

## ğŸš€ Khá»Ÿi cháº¡y nhanh

### CÃ¡ch 1: Cháº¡y tá»« Executable
```bash
# Copy exe vÃ  dll vÃ o cÃ¹ng má»™t thÆ° má»¥c
Fingerprint Scanner/
â”œâ”€â”€ Fingerprint Scanner.exe
â””â”€â”€ libzkfp.dll

# Cháº¡y á»©ng dá»¥ng
./Fingerprint Scanner.exe
```

### CÃ¡ch 2: Cháº¡y tá»« Source Code
```bash
# KÃ­ch hoáº¡t virtual environment
venv\Scripts\activate

# Cháº¡y á»©ng dá»¥ng
python http_server_fingerprint_scanner.py
```

## ğŸ”§ YÃªu cáº§u há»‡ thá»‘ng

### Hardware
- âœ… MÃ¡y quÃ©t vÃ¢n tay ZKTeco (USB)
- âœ… Windows 64-bit OS

### Software Dependencies
- âœ… ZKTeco driver Ä‘Ã£ cÃ i Ä‘áº·t
- âœ… libzkfp.dll (64-bit version)
- âœ… Python 3.8+ (náº¿u cháº¡y tá»« source)

## ğŸ“ Cáº¥u trÃºc DLL Loading

á»¨ng dá»¥ng sáº½ tÃ¬m `libzkfp.dll` theo thá»© tá»± Æ°u tiÃªn:

1. **C:\Windows\SysWOW64\libzkfp.dll** - Folder máº·c Ä‘á»‹nh khi cÃ i driver
2. **[Executable Directory]\libzkfp.dll** - CÃ¹ng thÆ° má»¥c vá»›i exe
3. **[Current Directory]\libzkfp.dll** - ThÆ° má»¥c lÃ m viá»‡c hiá»‡n táº¡i
4. **System PATH** - Fallback tÃ¬m trong PATH environment

## ğŸŒ API Documentation

### Server Information
- **Base URL**: `http://127.0.0.1:8080/api`
- **Content-Type**: `application/json`
- **CORS**: Enabled cho development

### Core Endpoints

#### 1. Test Connection
```http
GET /api/test
```
**Response:**
```json
{
    "status": "success",
    "message": "API is working",
    "timestamp": "2025-08-22T16:27:40"
}
```

#### 2. Initialize Scanner
```http
POST /api/scanner/initialize
```
**Response:**
```json
{
    "success": true,
    "message": "Scanner connected: 288x375",
    "resolution": {
        "width": 288,
        "height": 375
    }
}
```

#### 3. Capture Fingerprint
```http
POST /api/fingerprint/capture
```
**Request Body:**
```json
{
    "employeeId": "TIQN-0148",
    "fingerIndex": 6,
    "fingerName": "Right Index"
}
```

**Response:**
```json
{
    "success": true,
    "message": "Fingerprint captured successfully: 660 bytes, Quality: 91%",
    "data": {
        "fingerprint_template": "base64_encoded_template_data",
        "quality_score": 91,
        "template_size": 660,
        "finger_name": "Right Index",
        "enrollment_details": {
            "scan_1": {"quality": 90, "size": 844},
            "scan_2": {"quality": 91, "size": 660},
            "scan_3": {"quality": 90, "size": 488}
        }
    }
}
```

#### 4. Disconnect Scanner
```http
POST /api/scanner/disconnect
```

#### 5. Get Real-time Logs
```http
GET /api/logs/since?since=16:27:41
```

### Finger Index Mapping
| Index | Finger Name |
|-------|-------------|
| 0 | Left Thumb |
| 1 | Left Index |
| 2 | Left Middle |
| 3 | Left Ring |
| 4 | Left Little |
| 5 | Right Thumb |
| 6 | Right Index |
| 7 | Right Middle |
| 8 | Right Ring |
| 9 | Right Little |

## ğŸ”„ 3-Scan Enrollment Process

Äá»ƒ Ä‘áº£m báº£o cháº¥t lÆ°á»£ng cao, á»©ng dá»¥ng sá»­ dá»¥ng quy trÃ¬nh 3 láº§n quÃ©t:

1. **Scan 1**: Thu tháº­p template Ä‘áº§u tiÃªn
2. **Scan 2**: Thu tháº­p template thá»© hai (sau 2s delay)
3. **Scan 3**: Thu tháº­p template thá»© ba (sau 2s delay)
4. **Merge**: Káº¿t há»£p 3 template thÃ nh final template tá»‘i Æ°u

### Real-time Status Tracking
```
â³ Láº¦N 1 WAITING â†’ âœ… Láº¦N 1 OK (Quality: 90%)
â³ Láº¦N 2 WAITING â†’ âœ… Láº¦N 2 OK (Quality: 91%)
â³ Láº¦N 3 WAITING â†’ âœ… Láº¦N 3 OK (Quality: 90%)
ğŸ”„ Processing and merging...
ğŸ‰ ENROLLMENT COMPLETED - Final Quality: 91%
```

## ğŸ› ï¸ Build vÃ  Deploy

### Build Executable
```bash
# Cháº¡y build script
build_exe.bat

# Output sáº½ Ä‘Æ°á»£c táº¡o trong folder:
Fingerprint Scanner/
â”œâ”€â”€ Fingerprint Scanner.exe
â””â”€â”€ libzkfp.dll
```

### Deploy Requirements
1. Copy toÃ n bá»™ folder `Fingerprint Scanner/` 
2. Äáº£m báº£o mÃ¡y Ä‘Ã­ch Ä‘Ã£ cÃ i ZKTeco driver
3. Káº¿t ná»‘i mÃ¡y quÃ©t vÃ¢n tay qua USB
4. Cháº¡y `Fingerprint Scanner.exe`

## ğŸ” Troubleshooting

### Common Issues

#### 1. DLL Load Failed
```
âŒ Could not load libzkfp.dll from any location
```
**Solution:**
- CÃ i Ä‘áº·t ZKTeco driver
- Copy libzkfp.dll vÃ o cÃ¹ng thÆ° má»¥c exe
- Kiá»ƒm tra DLL architecture (pháº£i lÃ  64-bit)

#### 2. Scanner Not Found
```
âŒ KhÃ´ng tÃ¬m tháº¥y thiáº¿t bá»‹ quÃ©t vÃ¢n tay nÃ o
```
**Solution:**
- Kiá»ƒm tra káº¿t ná»‘i USB
- Restart scanner device
- Kiá»ƒm tra Device Manager

#### 3. SDK Init Failed
```
âŒ KhÃ´ng thá»ƒ khá»Ÿi táº¡o SDK mÃ¡y quÃ©t vÃ¢n tay
```
**Solution:**
- ÄÃ³ng cÃ¡c á»©ng dá»¥ng khÃ¡c Ä‘ang sá»­ dá»¥ng scanner
- Restart á»©ng dá»¥ng
- Restart scanner device

#### 4. Port Already in Use
```
âŒ Address already in use: 127.0.0.1:8080
```
**Solution:**
- ÄÃ³ng instance khÃ¡c cá»§a á»©ng dá»¥ng
- Äá»•i port trong code náº¿u cáº§n

### Debug Information

á»¨ng dá»¥ng cung cáº¥p debug info chi tiáº¿t:
```
ğŸ” Debug info:
   - sys.frozen: True/False
   - sys.executable: D:\Fingerprint Scanner.exe
   - __file__: D:\functions_fingerprint_scanner.py
   - os.getcwd(): D:\
```

### Log Levels
- **INFO**: ThÃ´ng tin hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng
- **WARNING**: Cáº£nh bÃ¡o khÃ´ng áº£nh hÆ°á»Ÿng chá»©c nÄƒng
- **ERROR**: Lá»—i nghiÃªm trá»ng cáº§n xá»­ lÃ½

## ğŸ“ Support

### Technical Specifications
- **Scanner Resolution**: 288x375 pixels
- **Template Size**: ~500-900 bytes
- **Quality Threshold**: â‰¥50%
- **Timeout**: 30 seconds per scan
- **API Response Time**: <3 seconds

### Contact
- **Developer**: Development Team
- **Version**: 1.0.0
- **Last Updated**: August 2025

---

*Fingerprint Scanner Bridge - Connecting hardware to web applications seamlessly* ğŸ”—